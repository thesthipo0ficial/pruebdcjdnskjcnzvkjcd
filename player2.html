<!DOCTYPE html>
<html>
<head>
    <title>Reproductor de Video</title>
    <link rel="stylesheet" href="https://cdn.plyr.io/3.6.2/plyr.css" />
</head>
<body>
    <div>
        <video id="my-video" class="plyr" controls poster="" crossorigin>
            <!-- Aquí puedes agregar múltiples fuentes de video compatibles -->
        </video>
        <button id="play-button">Play Video</button>
    </div>
    <script src="https://cdn.plyr.io/3.6.2/plyr.js"></script>
    <script>
        const videoPlayer = new Plyr('#my-video');

        function obtenerParametroDeURL(nombre) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(nombre);
        }

        const videoID = obtenerParametroDeURL("id");
        const apiKey = obtenerParametroDeURL("api_key");
        const posterURL = obtenerParametroDeURL("poster");

        if (videoID && apiKey) {
            // Hacer una solicitud a la API de Google Drive para obtener los enlaces de video
            fetch(`https://www.googleapis.com/drive/v3/files/${videoID}?alt=media&key=${apiKey}`)
                .then(response => response.json())
                .then(data => {
                    // Define el poster
                    videoPlayer.poster = posterURL || '';

                    // Agregar las fuentes de video
                    data.links.forEach(link => {
                        videoPlayer.source = {
                            type: 'video',
                            sources: [
                                {
                                    src: link.url,
                                    type: link.type,
                                },
                            ],
                        };
                    });

                    // Manejar la reproducción del video
                    const playButton = document.getElementById("play-button");
                    playButton.addEventListener("click", function() {
                        videoPlayer.play();
                    });
                    
                    // Reproducir el video
                    videoPlayer.play();
                })
                .catch(error => {
                    console.error("Error al obtener enlaces de video: " + error);
                });
        } else {
            // Manejar el caso en el que falta el ID de video o la clave de API
            console.error("ID de video o API key no proporcionados en la URL");
        }
    </script>
</body>
</html>

